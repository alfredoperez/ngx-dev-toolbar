---
import LandingLayout from '../layouts/LandingLayout.astro';
import { Code } from 'astro:components';

const version = '3.1.0';

const featureIcons: Record<string, string> = {
  featureFlags: '<path d="M112,128A32,32,0,1,1,80,96,32,32,0,0,1,112,128Z" opacity="0.2"/><path d="M176,56H80a72,72,0,0,0,0,144h96a72,72,0,0,0,0-144Zm0,128H80A56,56,0,0,1,80,72h96a56,56,0,0,1,0,112ZM80,88a40,40,0,1,0,40,40A40,40,0,0,0,80,88Zm0,64a24,24,0,1,1,24-24A24,24,0,0,1,80,152Z"/>',
  languageSwitcher: '<path d="M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"/>',
  customTools: '<path d="M69.12,94.15,28.5,128l40.62,33.85a8,8,0,1,1-10.24,12.29l-48-40a8,8,0,0,1,0-12.29l48-40a8,8,0,0,1,10.24,12.29Zm176,27.7-48-40a8,8,0,1,0-10.24,12.29L227.5,128l-40.62,33.85a8,8,0,1,0,10.24,12.29l48-40a8,8,0,0,0,0-12.29ZM162.73,32.48a8,8,0,0,0-10.25,4.79l-64,176a8,8,0,0,0,4.79,10.26A8.14,8.14,0,0,0,96,224a8,8,0,0,0,7.52-5.27l64-176A8,8,0,0,0,162.73,32.48Z"/>',
};

const features = [
  {
    id: 'featureFlags',
    title: 'Feature Flags',
    description: 'Test new features instantly without backend changes. Perfect for A/B testing and gradual rollouts in development.',
    benefits: [
      'Toggle features on/off in real-time',
      'Test different user experiences',
      'No backend configuration needed',
      'Settings persist across sessions',
    ],
    image: '/ngx-dev-toolbar/assets/demos/feature-flags-demo.gif',
    imageAlt: 'Feature Flags Demo',
  },
  {
    id: 'languageSwitcher',
    title: 'Language Switcher',
    description: 'Preview your app in different languages instantly. Test UI layouts with varying text lengths and validate translations in real-time.',
    benefits: [
      'Switch languages without reloading',
      'Test UI with different text lengths',
      'Validate translations instantly',
      'Support for multiple locales',
    ],
    image: '/ngx-dev-toolbar/assets/demos/language-switcher-demo.gif',
    imageAlt: 'Language Switcher Demo',
  },
  {
    id: 'customTools',
    title: 'Create Your Own Tools',
    description: 'Build custom development tools that match your workflow. Create, share, and integrate tools across your team using familiar Angular components.',
    benefits: [
      'Build tools using Angular components',
      'Share tools across your team',
      'Integrate with existing services',
      'Customize for your workflow',
    ],
    image: '/ngx-dev-toolbar/assets/demos/toolbar-tool-demo.gif',
    imageAlt: 'Custom Tools Demo',
  },
];

const steps = [
  {
    id: 1,
    title: 'Initialize Toolbar',
    description: 'Add Angular Toolbar to your main.ts with zero production bundle impact',
    code: `// main.ts
import { bootstrapApplication } from '@angular/platform-browser';
import { AppComponent } from './app/app.component';
import { isDevMode } from '@angular/core';

async function bootstrap() {
  const appRef = await bootstrapApplication(AppComponent, appConfig);

  // ðŸ‘‡ðŸ‘‡ Initialize toolbar only in development ðŸ‘‡ðŸ‘‡
  if (isDevMode()) {
    const { initToolbar } = await import('ngx-dev-toolbar');
    initToolbar(appRef);
  }
}

bootstrap();`,
  },
  {
    id: 2,
    title: 'Configure Flags',
    description: 'Set available options from the service managing your feature flags',
    code: `// 1. Get the flags from the service
this.appFlagsService.flags$.pipe(

  // 2. Map the flags to the format expected by the toolbar
  map((flags) =>
    flags.map((flag) => ({
      id: flag.name,
      name: flag.name,
      description: flag.description,
      isEnabled: flag.enabled,
    }))
  ),

  // 3. ðŸ‘‡ðŸ‘‡ Set the flags to the toolbar ðŸ‘‡ðŸ‘‡
  tap((flags) =>
    this.devToolbarFlags.setAvailableOptions(flags)
  )
)`,
  },
  {
    id: 3,
    title: 'Read Flag Values',
    description: 'Get the forced values from Angular Toolbar to find overridden flags',
    code: `flags$ = combineLatest([
  // 1. Get the flags from the application
  this.appFlagsService.flags$,

  // 2. ðŸ‘‡ðŸ‘‡ Get the forced values from the toolbar ðŸ‘‡ðŸ‘‡
  this.devToolbarFlags.getForcedValues()
]).pipe(

  // 3. Map the flags to the format expected by the application
  map(([flags, forcedFlags]) => {
    const flag = flags.find(
        (f) => f.name === flagName);
    const forcedFlag = forcedFlags.find(
         (f) => f.id === flagName);

    return forcedFlag?.isForced
        ? forcedFlag?.isEnabled
         : flag?.enabled;
  })
)`,
  },
];

const additionalFeatures = [
  { name: 'Zero Production Impact', available: true },
  { name: 'Secure Implementation', available: true },
  { name: 'Persistent Settings', available: true },
  { name: 'Hidden by Default', available: true },
  { name: 'Custom Tools Support', available: true },
  { name: 'Feature Flags Management', available: true },
  { name: 'Language Switching', available: true },
  { name: 'Mock User Personas', available: false },
  { name: 'Network Request Mocking', available: false },
  { name: 'Import/Export Settings', available: false },
  { name: 'Advanced Theming', available: false },
];
---

<LandingLayout
  title="Angular Toolbar - Supercharge Your Angular Development"
  description="Build Angular apps faster with instant feature toggles, real-time language switching, and powerful development tools."
>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- HERO SECTION                                -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="relative isolate overflow-hidden bg-surface-1">
    <!-- Grid pattern -->
    <svg class="absolute inset-0 -z-10 size-full stroke-white/[0.04] [mask-image:radial-gradient(100%_100%_at_top_right,white,transparent)]" aria-hidden="true">
      <defs>
        <pattern id="hero-grid" width="200" height="200" x="50%" y="-1" patternUnits="userSpaceOnUse">
          <path d="M.5 200V.5H200" fill="none" />
        </pattern>
      </defs>
      <svg x="50%" y="-1" class="overflow-visible fill-surface-3/20">
        <path d="M-200 0h201v201h-201Z M600 0h201v201h-201Z M-400 600h201v201h-201Z M200 800h201v201h-201Z" stroke-width="0" />
      </svg>
      <rect width="100%" height="100%" stroke-width="0" fill="url(#hero-grid)" />
    </svg>

    <!-- Gradient blob -->
    <div class="absolute left-[calc(50%-4rem)] top-10 -z-10 transform-gpu blur-3xl sm:left-[calc(50%-18rem)] lg:left-48 lg:top-[calc(50%-30rem)] xl:left-[calc(50%-24rem)]" aria-hidden="true">
      <div class="aspect-[1108/632] w-[69.25rem] bg-gradient-to-r from-blue-500/20 to-brand-600/20 opacity-40" style="clip-path: polygon(73.6% 51.7%, 91.7% 11.8%, 100% 46.4%, 97.4% 82.2%, 92.5% 84.9%, 75.7% 64%, 55.3% 47.5%, 46.5% 49.4%, 45% 62.9%, 50.3% 87.2%, 21.3% 64.1%, 0.1% 100%, 5.4% 51.1%, 21.4% 63.9%, 58.9% 0.2%, 73.6% 51.7%);"></div>
    </div>

    <div class="mx-auto max-w-7xl px-6 pb-20 pt-10 sm:pb-28 lg:flex lg:items-center lg:px-8 lg:py-28">
      <!-- Left column -->
      <div class="mx-auto max-w-2xl shrink-0 lg:mx-0 lg:pt-8 hero-content">
        <div class="mt-20 sm:mt-28 lg:mt-0">
          <!-- Version badge -->
          <div class="flex items-center gap-3 animate-fade-in" style="animation-delay: 0ms;">
            <span class="rounded-full bg-brand-500/10 px-3 py-1 text-sm font-semibold text-brand-400 ring-1 ring-inset ring-brand-500/20">
              v{version}
            </span>
            <a
              href="https://github.com/alfredoperez/ngx-dev-toolbar/blob/main/CHANGELOG.md"
              target="_blank"
              rel="noopener"
              class="inline-flex items-center text-sm font-medium text-gray-400 hover:text-brand-400 transition-colors"
            >
              Changelog <span aria-hidden="true" class="ml-1">&rarr;</span>
            </a>
          </div>
        </div>

        <!-- Title block -->
        <div class="mt-8 animate-fade-in" style="animation-delay: 80ms;">
          <h1 class="text-5xl sm:text-7xl font-extrabold tracking-tight leading-[1.05]">
            <span class="block bg-gradient-to-r from-blue-400 via-brand-400 to-blue-500 bg-clip-text text-transparent" style="text-shadow: 0 0 80px rgba(99,102,241,0.15);">
              Angular Toolbar
            </span>
          </h1>
          <p class="mt-5 text-2xl font-medium tracking-tight text-white/80 sm:text-3xl">
            Supercharge Your Angular Development
          </p>
          <p class="mt-6 text-lg text-gray-400 sm:text-xl/8 max-w-xl">
            Build Angular apps faster with instant feature toggles, real-time language switching, and powerful development tools &mdash; all without leaving your current page or touching production code.
          </p>
        </div>

        <!-- CTAs -->
        <div class="mt-10 flex flex-wrap items-center gap-4 animate-fade-in" style="animation-delay: 160ms;">
          <a
            href="/ngx-dev-toolbar/docs/"
            class="group relative inline-flex items-center gap-2 rounded-lg bg-brand-600 px-5 py-2.5 text-sm font-semibold text-white shadow-lg shadow-brand-600/25 hover:bg-brand-500 hover:shadow-brand-500/30 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-400 transition-all duration-200"
          >
            Install from NPM
            <span class="absolute inset-0 rounded-lg ring-1 ring-inset ring-white/10"></span>
          </a>
          <a
            href="/ngx-dev-toolbar/demo/"
            class="rounded-lg bg-white/[0.06] px-5 py-2.5 text-sm font-semibold text-white ring-1 ring-inset ring-white/10 hover:bg-white/10 transition-colors"
          >
            Try Demo
          </a>
          <a
            href="/ngx-dev-toolbar/docs/"
            class="text-sm font-semibold text-brand-400 hover:text-brand-300 transition-colors"
          >
            Documentation <span aria-hidden="true">&rarr;</span>
          </a>
          <a
            href="https://github.com/alfredoperez/ngx-dev-toolbar"
            target="_blank"
            rel="noopener"
            class="text-sm font-semibold text-gray-300 hover:text-white transition-colors"
          >
            GitHub <span aria-hidden="true">&rarr;</span>
          </a>
        </div>
      </div>

      <!-- Right column: hero image -->
      <div class="mx-auto mt-16 flex max-w-2xl sm:mt-24 lg:ml-10 lg:mr-0 lg:mt-0 lg:max-w-none lg:flex-none xl:ml-20 animate-fade-in" style="animation-delay: 240ms;">
        <div class="max-w-3xl flex-none sm:max-w-5xl lg:max-w-none">
          <img
            src="/ngx-dev-toolbar/assets/images/hero-demo.jpg"
            alt="ngx-dev-toolbar demo showing the toolbar in action"
            width="640"
            height="640"
            class="w-[36rem] h-auto object-contain rounded-xl bg-white/5 shadow-2xl ring-1 ring-white/10"
            loading="eager"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- FEATURES SECTION                            -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="relative bg-surface-0">
    <div class="mx-auto max-w-7xl px-6 py-24 lg:py-32">
      <!-- Section header -->
      <div class="text-center animate-on-scroll">
        <span class="rounded-full bg-brand-500/10 px-3 py-1 text-sm font-semibold text-brand-400 ring-1 ring-inset ring-brand-500/20">
          Features
        </span>
        <h2 class="mt-4 text-3xl font-bold text-white tracking-tight">
          Development Tools That Work For You
        </h2>
        <p class="mt-4 text-lg text-gray-400 max-w-2xl mx-auto">
          Everything you need to streamline your Angular development workflow
        </p>
      </div>

      <div class="mt-20 grid lg:grid-cols-2 gap-12 items-start">
        <!-- Feature accordion -->
        <div class="space-y-4 order-2 lg:order-1" id="feature-accordion">
          {features.map((feature, index) => (
            <button
              class:list={[
                'feature-card w-full text-left rounded-xl border p-6 transition-all duration-300 cursor-pointer',
                index === 0
                  ? 'border-brand-500/30 bg-surface-2 shadow-lg shadow-brand-500/5'
                  : 'border-gray-800 bg-surface-1 hover:border-gray-700 hover:bg-surface-2/50',
              ]}
              data-feature={feature.id}
              data-image={feature.image}
              data-alt={feature.imageAlt}
              aria-expanded={index === 0 ? 'true' : 'false'}
            >
              <div class="flex items-center gap-4">
                <div class:list={[
                  'flex h-10 w-10 items-center justify-center rounded-lg transition-colors',
                  index === 0 ? 'bg-brand-500/20' : 'bg-surface-3',
                ]}>
                  <svg class="w-5 h-5 text-brand-400" viewBox="0 0 256 256" fill="currentColor" set:html={featureIcons[feature.id]} />
                </div>
                <h3 class="text-base font-semibold text-white">{feature.title}</h3>
                <svg class:list={[
                  'ml-auto w-5 h-5 text-gray-500 transition-transform duration-300 feature-chevron',
                  index === 0 ? 'rotate-180' : '',
                ]} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </div>

              <div class:list={[
                'feature-content overflow-hidden transition-all duration-300',
                index === 0 ? 'max-h-96 opacity-100 mt-4' : 'max-h-0 opacity-0',
              ]}>
                <p class="text-gray-400 mb-4">{feature.description}</p>
                <ul class="space-y-2">
                  {feature.benefits.map((benefit) => (
                    <li class="flex items-center gap-2.5 text-sm text-gray-300">
                      <svg class="w-4 h-4 text-brand-400 flex-shrink-0" viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z" clip-rule="evenodd" />
                      </svg>
                      {benefit}
                    </li>
                  ))}
                </ul>
              </div>
            </button>
          ))}
        </div>

        <!-- Demo image -->
        <div class="lg:sticky lg:top-8 order-1 lg:order-2">
          <img
            id="feature-image"
            src="/ngx-dev-toolbar/assets/demos/feature-flags-demo.gif"
            alt="Feature Flags Demo"
            class="rounded-xl bg-white/5 shadow-2xl ring-1 ring-white/10 transition-opacity duration-300"
            loading="lazy"
          />
        </div>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- HOW TO USE SECTION                          -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="relative bg-surface-1">
    <div class="mx-auto max-w-7xl px-6 py-24 lg:py-32">
      <!-- Section header -->
      <div class="text-center animate-on-scroll">
        <span class="rounded-full bg-brand-500/10 px-3 py-1 text-sm font-semibold text-brand-400 ring-1 ring-inset ring-brand-500/20">
          How to use
        </span>
        <h2 class="mt-4 text-3xl font-bold tracking-tight text-white">
          Toggle Feature Flags Right From Your Browser
        </h2>
        <p class="mt-4 text-lg text-gray-400 max-w-2xl mx-auto">
          Enhance your development workflow with the Angular Toolbar. Toggle feature flags instantly without changing code or redeploying.
        </p>
      </div>

      <div class="mt-20 lg:grid lg:grid-cols-12 lg:gap-8">
        <!-- Code display -->
        <div class="hidden lg:block lg:col-span-7">
          <div class="h-[34rem] overflow-hidden rounded-xl bg-surface-0 ring-1 ring-white/10 shadow-2xl">
            <div class="flex items-center gap-2 px-4 py-3 border-b border-gray-800/80">
              <div class="flex gap-1.5">
                <div class="w-3 h-3 rounded-full bg-red-500/60"></div>
                <div class="w-3 h-3 rounded-full bg-yellow-500/60"></div>
                <div class="w-3 h-3 rounded-full bg-green-500/60"></div>
              </div>
              <span class="text-xs text-gray-500 font-mono ml-2" id="code-filename">main.ts</span>
            </div>
            <div class="relative h-full overflow-auto p-6">
              {steps.map((step) => (
                <div class:list={['code-step-block', step.id !== 1 && 'hidden']} data-code-step={step.id}>
                  <Code code={step.code} lang="typescript" theme="night-owl" />
                </div>
              ))}
            </div>
          </div>
        </div>

        <!-- Stepper -->
        <nav class="lg:col-span-5" aria-label="Setup steps">
          <ol class="space-y-0">
            {steps.map((step) => (
              <li class="relative">
                <button
                  class:list={[
                    'step-button w-full text-left border-l-2 transition-all duration-200 cursor-pointer',
                    step.id === 1
                      ? 'border-brand-500 bg-brand-500/5'
                      : 'border-gray-800 hover:bg-surface-2/30',
                  ]}
                  data-step={step.id}
                >
                  <div class="flex items-start px-6 py-6">
                    <span class="shrink-0">
                      <span class:list={[
                        'flex size-10 items-center justify-center rounded-full border-2 transition-colors',
                        step.id === 1 ? 'border-brand-500' : 'border-gray-700',
                      ]}>
                        <span class:list={[
                          'text-sm font-semibold',
                          step.id === 1 ? 'text-brand-400' : 'text-gray-500',
                        ]}>
                          {String(step.id).padStart(2, '0')}
                        </span>
                      </span>
                    </span>
                    <span class="ml-4 mt-0.5 flex min-w-0 flex-col">
                      <span class:list={[
                        'text-sm font-semibold transition-colors',
                        step.id === 1 ? 'text-brand-400' : 'text-gray-400',
                      ]}>
                        {step.title}
                      </span>
                      <span class="text-sm text-gray-500 mt-1">
                        {step.description}
                      </span>
                    </span>
                  </div>
                </button>

                <!-- Mobile code -->
                <div class:list={[
                  'step-mobile-code lg:hidden overflow-hidden transition-all duration-300',
                  step.id === 1 ? 'max-h-[500px] opacity-100' : 'max-h-0 opacity-0',
                ]} data-mobile-step={step.id}>
                  <div class="mx-6 mb-4 rounded-lg bg-surface-0 p-4 ring-1 ring-white/10 overflow-x-auto code-step-mobile">
                    <Code code={step.code} lang="typescript" theme="night-owl" />
                  </div>
                </div>
              </li>
            ))}
          </ol>
        </nav>
      </div>
    </div>
  </section>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- ADDITIONAL FEATURES SECTION                 -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <section class="relative bg-surface-0">
    <div class="bg-surface-2/50 py-24 lg:py-32">
      <div class="mx-auto max-w-7xl px-6">
        <div class="text-center animate-on-scroll">
          <span class="rounded-full bg-brand-500/10 px-3 py-1 text-sm font-semibold text-brand-400 ring-1 ring-inset ring-brand-500/20">
            Additional Features
          </span>
          <h2 class="mt-4 text-3xl font-bold text-white tracking-tight">
            Packed with Everything You Need
          </h2>
          <p class="mt-4 text-lg text-gray-400">
            Comprehensive tools to enhance your development experience
          </p>

          <!-- Feature grid -->
          <div class="py-20">
            <div class="grid lg:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-x-16 gap-y-8 max-w-5xl mx-auto">
              {additionalFeatures.map((feature, index) => (
                <div
                  class="additional-feature-item flex items-center gap-3 text-left"
                  style={`animation-delay: ${60 * (index % 3 + 1)}ms;`}
                >
                  <div class="flex-shrink-0">
                    <svg class="w-5 h-5 text-brand-400" viewBox="0 0 24 24" fill="currentColor">
                      <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z" clip-rule="evenodd" />
                    </svg>
                  </div>
                  <p class="text-lg font-medium text-gray-300">{feature.name}</p>
                  {!feature.available && (
                    <span class="flex-shrink-0 text-xs font-medium bg-brand-500/20 text-brand-400 px-2.5 py-1 rounded-full">
                      Coming Soon
                    </span>
                  )}
                </div>
              ))}
            </div>
          </div>

          <!-- CTA -->
          <a
            href="/ngx-dev-toolbar/docs/"
            class="inline-flex items-center gap-2 rounded-lg bg-brand-600 px-6 py-3 text-sm font-semibold text-white shadow-lg shadow-brand-600/25 hover:bg-brand-500 transition-all duration-200"
          >
            Start Using it Now
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

</LandingLayout>

<style>
  /* Entrance animation */
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: translateY(12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    opacity: 0;
    animation: fade-in 0.6s ease-out forwards;
  }

  /* Scroll-triggered reveal */
  .animate-on-scroll {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  .animate-on-scroll.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Additional features stagger */
  .additional-feature-item {
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
  }

  .additional-feature-item.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .additional-feature-item:hover {
    transform: translateX(4px);
    transition: transform 0.15s ease-in-out;
  }

  /* Shiki code block overrides for landing page */
  .code-step-block :global(pre) {
    background: transparent !important;
    margin: 0;
    padding: 0;
    border: none;
    font-size: 0.875rem;
    line-height: 1.625;
  }

  .code-step-mobile :global(pre) {
    background: transparent !important;
    margin: 0;
    padding: 0;
    border: none;
    font-size: 0.75rem;
    line-height: 1.625;
  }
</style>

<script>
  // â”€â”€ Feature accordion â”€â”€
  const accordion = document.getElementById('feature-accordion');
  const featureImage = document.getElementById('feature-image') as HTMLImageElement;

  accordion?.querySelectorAll('.feature-card').forEach((card) => {
    card.addEventListener('click', () => {
      const thisId = card.getAttribute('data-feature');

      accordion.querySelectorAll('.feature-card').forEach((c) => {
        const isTarget = c.getAttribute('data-feature') === thisId;
        const content = c.querySelector('.feature-content') as HTMLElement;
        const chevron = c.querySelector('.feature-chevron') as HTMLElement;
        const iconWrap = c.querySelector('.flex.h-10') as HTMLElement;

        if (isTarget) {
          c.classList.add('border-brand-500/30', 'bg-surface-2', 'shadow-lg', 'shadow-brand-500/5');
          c.classList.remove('border-gray-800', 'bg-surface-1');
          c.setAttribute('aria-expanded', 'true');
          content.classList.remove('max-h-0', 'opacity-0');
          content.classList.add('max-h-96', 'opacity-100', 'mt-4');
          chevron?.classList.add('rotate-180');
          iconWrap?.classList.add('bg-brand-500/20');
          iconWrap?.classList.remove('bg-surface-3');
        } else {
          c.classList.remove('border-brand-500/30', 'bg-surface-2', 'shadow-lg', 'shadow-brand-500/5');
          c.classList.add('border-gray-800', 'bg-surface-1');
          c.setAttribute('aria-expanded', 'false');
          content.classList.add('max-h-0', 'opacity-0');
          content.classList.remove('max-h-96', 'opacity-100', 'mt-4');
          chevron?.classList.remove('rotate-180');
          iconWrap?.classList.remove('bg-brand-500/20');
          iconWrap?.classList.add('bg-surface-3');
        }
      });

      // Swap image
      if (featureImage) {
        featureImage.style.opacity = '0';
        setTimeout(() => {
          featureImage.src = card.getAttribute('data-image') || '';
          featureImage.alt = card.getAttribute('data-alt') || '';
          featureImage.style.opacity = '1';
        }, 150);
      }
    });
  });

  // â”€â”€ Step switcher â”€â”€
  document.querySelectorAll('.step-button').forEach((btn) => {
    btn.addEventListener('click', () => {
      const stepId = btn.getAttribute('data-step');

      // Update desktop code display (show/hide pre-rendered blocks)
      document.querySelectorAll('.code-step-block').forEach((block) => {
        if (block.getAttribute('data-code-step') === stepId) {
          block.classList.remove('hidden');
        } else {
          block.classList.add('hidden');
        }
      });
      const filename = document.getElementById('code-filename');
      if (filename) filename.textContent = stepId === '1' ? 'main.ts' : 'feature-flags.service.ts';

      // Update step buttons
      document.querySelectorAll('.step-button').forEach((b) => {
        const isActive = b.getAttribute('data-step') === stepId;
        const circle = b.querySelector('.flex.size-10') as HTMLElement;
        const number = circle?.querySelector('span') as HTMLElement;
        const title = b.querySelector('.font-semibold:not(.size-10 span)') as HTMLElement;

        if (isActive) {
          b.classList.add('border-brand-500', 'bg-brand-500/5');
          b.classList.remove('border-gray-800');
          circle?.classList.add('border-brand-500');
          circle?.classList.remove('border-gray-700');
          number?.classList.add('text-brand-400');
          number?.classList.remove('text-gray-500');
          title?.classList.add('text-brand-400');
          title?.classList.remove('text-gray-400');
        } else {
          b.classList.remove('border-brand-500', 'bg-brand-500/5');
          b.classList.add('border-gray-800');
          circle?.classList.remove('border-brand-500');
          circle?.classList.add('border-gray-700');
          number?.classList.remove('text-brand-400');
          number?.classList.add('text-gray-500');
          title?.classList.remove('text-brand-400');
          title?.classList.add('text-gray-400');
        }
      });

      // Update mobile code blocks
      document.querySelectorAll('[data-mobile-step]').forEach((block) => {
        const isActive = block.getAttribute('data-mobile-step') === stepId;
        if (isActive) {
          block.classList.remove('max-h-0', 'opacity-0');
          block.classList.add('max-h-[500px]', 'opacity-100');
        } else {
          block.classList.add('max-h-0', 'opacity-0');
          block.classList.remove('max-h-[500px]', 'opacity-100');
        }
      });
    });
  });

  // â”€â”€ Scroll animations â”€â”€
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');

          // Stagger child items
          if (entry.target.classList.contains('animate-on-scroll')) {
            const items = entry.target.parentElement?.querySelectorAll('.additional-feature-item');
            items?.forEach((item, i) => {
              setTimeout(() => item.classList.add('visible'), 60 * (i + 1));
            });
          }
        }
      });
    },
    { threshold: 0.1 }
  );

  document.querySelectorAll('.animate-on-scroll, .additional-feature-item').forEach((el) => {
    observer.observe(el);
  });
</script>
